const { Board, Stepper, Servo } = require("johnny-five");
const board = new Board();

const hardware = {
  pen: {
    pin: 11,
  },
};

const instructionSequence = [
  [-26.323544918069313, -54.02277512499816],
  [-329.39371863761073, -583.080399996645],
  [103.09317388541199, -448.1855959470487],
  [2.945907215480362, -40.28769471614201],
  [-44.36030853717521, -4.970391441559387],
  [-520.8526377287494, -97.43763537155556],
  [-530.4628260170492, -546.5017157372988],
  [-47.82407089124959, -48.759710803819836],
  [10.191154608039147, 41.94859065513047],
  [72.59833739453744, 470.90879485750247],
  [-470.9087948575025, -72.59833739453741],
  [-41.948590655130424, -10.19115460803917],
  [48.75971080381988, 47.82407089124957],
  [546.5017157372987, 530.4628260170492],
  [97.43763537155556, 520.8526377287494],
  [4.970391441559387, 44.36030853717521],
  [40.28769471614207, -2.945907215480384],
  [448.1855959470486, -103.09317388541196],
  [583.080399996645, 329.39371863761073],
  [54.02277512499816, 26.323544918069313],
  [-100.05123300958823, -100.05123300958823],
  [-544.415656474699, -306.34941031984545],
  [-14.273164969603856, -8.55102675151127],
  [-9.404619586761761, 3.414423344005353],
  [-413.01795166363905, 100.61674805776967],
  [-97.00044815959055, -492.57253375294516],
  [-3.900580719946021, -12.595672116264785],
  [-12.435038545497653, -12.16837269972533],
  [-512.9429156516295, -491.7310588687897],
  [442.59117235844604, 64.54695494612291],
  [10.124272211588515, 0.7150169598509347],
  [-0.7150169598509347, -10.124272211588515],
  [-64.54695494612291, -442.59117235844604],
  [491.7310588687897, 512.9429156516295],
  [12.16837269972533, 12.435038545497653],
  [12.595672116264783, 3.900580719946021],
  [492.5725337529451, 97.0004481595907],
  [-100.61674805776958, 413.0179516636389],
  [-3.414423344005276, 9.404619586761664],
  [8.551026751511232, 14.273164969603906],
  [306.3494103198454, 544.4156564746991],
];

board.on("ready", () => {
  const stepperLeft = new Stepper({
    type: Stepper.TYPE.DRIVER,
    stepsPerRev: 200,
    pins: {
      step: 2,
      dir: 5,
    },
  });
  const stepperRight = new Stepper({
    type: Stepper.TYPE.DRIVER,
    stepsPerRev: 200,
    pins: {
      step: 3,
      dir: 6,
    },
  });

  const pen = new Servo({
    pin: hardware.pen.pin,
    range: [0, 180],
    startAt: 0,
  });
  const liftPen = () => {
    pen.to(0);
  };
  const attachPen = () => {
    pen.to(180);
  };

  liftPen();

  stepperRight
    .rpm(180)
    .cw()
    .step(1600, () => {
      attachPen();
    });

  stepperLeft
    .rpm(180)
    .ccw()
    .step(1600, () => {
      attachPen();
    });
});
